#if(!$jsp.oldStruts)
#parse("templates/bpm4struts2/pages/page.jsp.vm")
#set ($generatedFile = "${jsp.fullPath}-fields.jsp")
#set ($securityEnabled = $stringUtils.isNotBlank($securityRealm))
##
##
## Codigo acrescentado para pegar action que cont�m parametros ##
<div id="fields">
#if ($jsp.actions.size() > 0)
#set ($action = $jsp.actions.get(0))
#set($achou = "false")
#foreach($_action in $jsp.actions)
#if(!$achou.equals("true"))
#if (!$_action.tableLink && !$_action.useCaseStart && !$_action.actionParameters.empty)
#set($action = $_action)
#set($achou = "true")
#end
#end
#end
## fim do codigo
##set ($action = $jsp.actions.get(0))
#if ($jsp.actions.size() > 0 && !$action.useCaseStart)## we don't generate tiles for events that do not have an input page
##
#set ($clientValidationDesired = ($clientValidation=='true'))
#set ($requiredness = ($clientValidationDesired || $serverValidation=='true'))
#set ($formBeanName = $action.formBeanName)
## Considera os par�metros de todas as a��es
#set ($actionParameters = $jsp.allUniqueActionParameters )
#set ($hints = $hints.equalsIgnoreCase("true"))
#set ($formBeanType = $action.formBeanType)## this will be the name of the form, as used in this page
#set($achou = false)
#foreach($jspAction in $jsp.actions)
#if($jspAction.hasStereotype("$enterAction"))
#if(!$jspAction.tableLink && $jspAction.formPost && !$achou)
#set($defaultAction = $jspAction)
#set($achou = true)
#end
#end
#end
#set ($messageKey = $action.messageKey)
#set ($actionTrigger = $action.actionTrigger)
#if ($action.tableAction)
## this means this action allows rows to be selected and sent
#elseif (($action.formPost || $action.hyperlink))
#if ($action.actionParameters.empty)
## unfortunately <html:form> cannot handle actions without a form so we need to treat this case separately
#else
#foreach($acao in $jsp.actions)
#if (!$acao.hiddenActionParameters.empty)
	<%@ include file="${acao.fullTilePath}-hidden-params.jspf" %>
#end
#end
#foreach ($field in $actionParameters)
#if (!$field.multiboxPropertyName && ($field.widgetType != "hidden") && !$field.table)
## for now multibox field can only be displayed in tables
#if($field.visivelPor)
#set ($visivel = 'style="display:none"')
#else
#set ($visivel = '')
#end
#set($valueFieldOperationMode = "")
#set($valueFieldOperationMode = $field.findTaggedValue("$fieldOperationMode"))
#if( $valueFieldOperationMode != "" && !${action.useCase.openAccess})
	<security:containsOperationMode value="$valueFieldOperationMode" useCase="${action.useCase.package.webModuleName}${action.useCase.actionPath}.action">
#end
#if ($securityEnabled && !${action.useCase.openAccess}) 	
	<security:containsPermission name="$field.messageKey">
#end
#renderFormField2($action $field '' "		")
#if ($securityEnabled && !${action.useCase.openAccess})
	</security:containsPermission>
#end
#if( $valueFieldOperationMode != "" && !${action.useCase.openAccess})
	</security:containsOperationMode>
#end
#end
#end
#end
#end
#end
#end

#set($incomingActions = $jsp.getIncomingActions())
#set($impressos = $collection.class.newInstance())
#foreach($incoming in $incomingActions)
#set($formFields = $incoming.getActionFormFields())
#foreach($param in $formFields)
#if($param.table && $param.tableType.equals("jtable"))
#foreach($parameter in $formFields)
#if(!$impressos.contains($parameter) && !$parameter.table)
	<s:set name="__value" value="#session.form.${parameter.name}" />
	<div id="divHidden${parameter.name}${parameter.jsp.useCase.name}" class=" hidden">
		<s:hidden id="${parameter.name}Hidden${parameter.jsp.useCase.name}" name="${parameter.name}"
			cssClass="hidden" label="" value="%{#session.form.${parameter.name}}"
			title="" styleId="${parameter.name}${parameter.jsp.useCase.name}" />
	</div>
#set($lixo = $impressos.add($parameter))
#end
#end
#end
#end
#end
</div>
#end